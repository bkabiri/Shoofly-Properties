<!-- app/views/favorites/index.html.erb -->
<%= render "shared/navbar" %>
<div class="container-xxl py-4">
  <h1 class="h4 mb-3">Saved properties</h1>

  <% if @listings.any? %>
    <div class="row g-3">
      <% @listings.each do |l| %>
        <div class="col-12 col-sm-6 col-lg-4">
          <div class="card h-100 shadow-sm border-0">
            <%= link_to listing_path(l), class: "text-decoration-none text-reset d-block" do %>
              <% if l.banner_image.attached? %>
                <%= image_tag(
                      l.banner_image.variable? ? l.banner_image.variant(resize_to_fill: [800, 520]).processed : l.banner_image,
                      class: "card-img-top", alt: l.title, loading: "lazy"
                    ) %>
              <% else %>
                <div class="bg-light ratio ratio-16x9 d-flex align-items-center justify-content-center text-muted">No image</div>
              <% end %>
              <div class="card-body">
                <h2 class="h6 mb-1"><%= l.title %></h2>
                <div class="text-muted small mb-2"><%= l.address %></div>
                <div class="fw-bold"><%= l.guide_price ? number_to_currency(l.guide_price, unit: "£", precision: 0) : "Guide price on request" %></div>
                <div class="mt-3 d-flex gap-2">
                  <span id="<%= dom_id(l, :fav_btn) %>">
                    <%= render "favorites/toggle", listing: l %>
                  </span>
                  <%= render "listings/message_button", listing: l %>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <div class="alert alert-light border">You haven’t saved any properties yet.</div>
  <% end %>
</div>
<%= render "shared/footer" %>