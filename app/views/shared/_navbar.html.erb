<%# ---------------- context helpers ---------------- %>
<% seller_area = controller_path.start_with?("seller/") %>
<% on_landing  = current_page?(root_path) %>

<%# When the navbar sits on the hero, keep it transparent; otherwise white %>
<nav class="navbar <%= on_landing ? 'navbar--transparent position-absolute top-0 start-0 w-100' : 'navbar--solid shadow-sm' %>">
  <div class="container d-flex align-items-center justify-content-between">

    <%# --------- Brand (left) --------- %>
    <%= link_to root_path, class: "navbar-brand d-flex align-items-center gap-2" do %>
      <svg xmlns="http://www.w3.org/2000/svg" width="34" height="34" viewBox="0 0 16 16" fill="#ff4a5f" aria-hidden="true">
        <path d="M7.293 1.5a1 1 0 0 1 1.414 0L11 3.793V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v3.293l2.354 2.353a.5.5 0 0 1-.708.707L8 2.207 1.354 8.853a.5.5 0 1 1-.708-.707z"/>
        <path d="m14 9.293-6-6-6 6V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5zm-6-.811c1.664-1.673 5.825 1.254 0 5.018-5.825-3.764-1.664-6.691 0-5.018"/>
      </svg>
      <span class="fw-bold fs-4" style="color:#ff4a5f;">Snoofly</span>
    <% end %>

    <%# --------- Right side: Start Selling + Burger --------- %>
    <div class="d-flex align-items-center gap-2">
  <%# Start Selling button (always visible) %>
  <% if user_signed_in? %>
    <%= link_to "Start Selling",
                dashboard_path,
                class: "btn px-3 fw-semibold",
                style: "background:#ff4a5f; color:#fff; border-radius:0.5rem;" %>
  <% else %>
    <%= link_to "Start Selling",
                new_user_registration_path,
                class: "btn px-3 fw-semibold",
                style: "background:#ff4a5f; color:#fff; border-radius:0.5rem;" %>
  <% end %>

  <%# Burger (always visible, opens offcanvas) %>
  <button
    class="burger-btn <%= on_landing ? 'burger-btn--light' : '' %>"
    type="button"
    data-bs-toggle="offcanvas"
    data-bs-target="#mainMenu"
    aria-controls="mainMenu"
    aria-label="Open menu">
    <span class="line"></span>
    <span class="line"></span>
    <span class="line"></span>
  </button>
</div>
  </div>
</nav>

<%# --------------------------------- Off-canvas menu --------------------------------- %>
<div class="offcanvas offcanvas-end" tabindex="-1" id="mainMenu" aria-labelledby="mainMenuLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title fw-bold" id="mainMenuLabel">Menu</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>

  <div class="offcanvas-body">
    <%# Top action (login/register or profile) %>
    <div class="d-grid gap-2 mb-3">
      <% if user_signed_in? %>
        <div class="text-muted small">Signed in as <%= current_user.email %></div>
        <%= link_to "My Dashboard", dashboard_path, class: "btn btn-outline-dark" %>
      <% else %>
        <%= link_to "Sign in / Register", new_user_session_path, class: "btn btn-outline-dark" %>
      <% end %>
    </div>

    <ul class="list-unstyled fs-5 lh-lg mb-0">
      <li><%= link_to "Listings", listings_path, class: "menu-link" %></li>
      <li><%= link_to "Saved properties", saved_properties_path, class: "menu-link" %></li>
      <li><%= link_to "Pricing", pricing_path, class: "menu-link" %></li>

      <% if user_signed_in? %>
        <li class="mt-2">
          <%= link_to "Sign out",
                      destroy_user_session_path,
                      data: { turbo_method: :delete },
                      class: "menu-link text-danger" %>
        </li>
      <% end %>
    </ul>
  </div>
</div>